<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <title>Creative Uploader – DESA & Bella Maison</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #f4f4f5;
      margin: 0;
      padding: 0;
    }
    .container {
      max-width: 720px;
      margin: 40px auto;
      background: #ffffff;
      border-radius: 16px;
      padding: 24px 28px 32px;
      box-shadow: 0 12px 30px rgba(15, 23, 42, 0.08);
      border: 1px solid #e4e4e7;
    }
    h1 {
      margin-top: 0;
      font-size: 24px;
      letter-spacing: 0.02em;
    }
    p.subtitle {
      margin-top: 4px;
      color: #6b7280;
      font-size: 14px;
    }
    form {
      margin-top: 20px;
    }
    .field {
      margin-bottom: 16px;
    }
    label {
      display: block;
      font-weight: 600;
      margin-bottom: 6px;
      font-size: 14px;
    }
    select,
    input[type="text"] {
      width: 100%;
      padding: 9px 10px;
      border-radius: 10px;
      border: 1px solid #d4d4d8;
      font-size: 14px;
      box-sizing: border-box;
    }
    select:focus,
    input[type="text"]:focus {
      outline: none;
      border-color: #6366f1;
      box-shadow: 0 0 0 1px rgba(99, 102, 241, 0.3);
    }
    .row {
      display: flex;
      gap: 12px;
    }
    .row > .field {
      flex: 1;
    }
    .helper {
      font-size: 12px;
      color: #9ca3af;
      margin-top: 4px;
    }
    button {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 9px 18px;
      border-radius: 999px;
      border: none;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      background: #111827;
      color: #f9fafb;
      margin-top: 8px;
    }
    button:disabled {
      opacity: 0.5;
      cursor: default;
    }
    .status {
      margin-top: 16px;
      font-size: 13px;
      min-height: 18px;
    }
    .status.ok {
      color: #16a34a;
    }
    .status.error {
      color: #dc2626;
    }
    pre {
      margin-top: 16px;
      background: #0b1120;
      color: #e5e7eb;
      padding: 14px 16px;
      border-radius: 12px;
      font-size: 12px;
      overflow-x: auto;
    }
    .tag-row {
      display: flex;
      gap: 8px;
      margin-top: 8px;
      font-size: 11px;
      color: #6b7280;
    }
    .tag {
      padding: 3px 8px;
      border-radius: 999px;
      border: 1px dashed #d4d4d8;
    }
    @media (max-width: 600px) {
      .container {
        margin: 16px;
        padding: 18px 16px 24px;
      }
      h1 {
        font-size: 20px;
      }
      .row {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Creative Uploader</h1>
    <p class="subtitle">
      DESA ve Bella Maison için görsel / video URL’sini gir, hem Meta’ya yükleyelim
      hem de Google Drive’da markaya özel klasöre kopyasını alalım.
    </p>

    <form id="uploadForm">
      <div class="row">
        <div class="field">
          <label for="brand">Marka</label>
          <select id="brand" name="brand" required>
            <option value="bella">Bella Maison</option>
            <option value="desa">DESA</option>
          </select>
          <div class="helper">Backend’de <code>BRAND_CONFIG</code> ile eşleşiyor.</div>
        </div>

        <div class="field">
          <label for="type">Medya tipi</label>
          <select id="type" name="type" required>
            <option value="image">Görsel (Image)</option>
            <option value="video">Video</option>
          </select>
        </div>
      </div>

      <div class="field">
        <label for="sourceUrl">Kaynak URL</label>
        <input
          type="text"
          id="sourceUrl"
          name="sourceUrl"
          placeholder="https://cdn.siten.com/path/to/file.jpg"
          required
        />
        <div class="helper">
          CDN / web site URL’si. Backend bu dosyayı indirip hem Meta’ya hem Drive’a gönderecek.
        </div>
      </div>

      <div class="field">
        <label for="fileName">Dosya adı (opsiyonel)</label>
        <input
          type="text"
          id="fileName"
          name="fileName"
          placeholder="BM_SS24_Look1_Story.jpg"
        />
        <div class="helper">
          Boş bırakırsan backend otomatik isim üretir (<code>brand_timestamp.ext</code>).
        </div>
      </div>

      <button type="submit" id="submitBtn">Yüklemeyi Başlat</button>

      <div class="tag-row">
        <div class="tag">Meta Ads API</div>
        <div class="tag">Google Drive API</div>
        <div class="tag">DESA / Bella Maison</div>
      </div>

      <div id="status" class="status"></div>
      <pre id="result" style="display:none;"></pre>
    </form>
  </div>

  <script>
    const form = document.getElementById('uploadForm');
    const statusEl = document.getElementById('status');
    const resultEl = document.getElementById('result');
    const submitBtn = document.getElementById('submitBtn');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      statusEl.textContent = '';
      statusEl.className = 'status';
      resultEl.style.display = 'none';
      resultEl.textContent = '';

      const brand = document.getElementById('brand').value;
      const type = document.getElementById('type').value;
      const sourceUrl = document.getElementById('sourceUrl').value.trim();
      const fileName = document.getElementById('fileName').value.trim();

      if (!sourceUrl) {
        statusEl.textContent = 'Lütfen geçerli bir kaynak URL gir.';
        statusEl.classList.add('error');
        return;
      }

      submitBtn.disabled = true;
      submitBtn.textContent = 'Yükleniyor...';

      try {
        const payload = { brand, type, sourceUrl };
        if (fileName) payload.fileName = fileName;

        const res = await fetch('/api/upload-creative', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(payload),
        });

        const json = await res.json();

        if (!res.ok || !json.ok) {
          statusEl.textContent =
            'Hata oluştu: ' + (json.error || ('HTTP ' + res.status));
          statusEl.classList.add('error');
        } else {
          statusEl.textContent = 'Yükleme başarılı ✔️';
          statusEl.classList.add('ok');
          resultEl.style.display = 'block';
          resultEl.textContent = JSON.stringify(json, null, 2);
        }
      } catch (err) {
        statusEl.textContent = 'Beklenmeyen hata: ' + err.message;
        statusEl.classList.add('error');
      } finally {
        submitBtn.disabled = false;
        submitBtn.textContent = 'Yüklemeyi Başlat';
      }
    });
  </script>
</body>
</html>
